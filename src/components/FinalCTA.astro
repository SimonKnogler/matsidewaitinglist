---
// Final CTA section with waitlist form
---

<section class="section relative overflow-hidden" id="cta">
  <!-- Background -->
  <div class="absolute inset-0 z-0">
    <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-purple-600/10 rounded-full blur-3xl"></div>
  </div>
  
  <div class="container relative z-10">
    <div class="max-w-3xl mx-auto text-center">
      <!-- Badge -->
      <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-purple-500/10 border border-purple-500/20 mb-8">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-purple-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
        </svg>
        <span class="text-sm text-purple-300 font-medium">Limited Early Access</span>
      </div>
      
      <!-- Headline -->
      <h2 class="text-3xl md:text-5xl font-bold mb-6" style="font-family: 'Space Grotesk', sans-serif;">
        Ready to Train Smarter?
      </h2>
      
      <p class="text-zinc-400 text-lg mb-8 max-w-xl mx-auto">
        Join the waitlist for early access. Be the first to know when we launch — plus get <strong class="text-white">50% off for life</strong> as a founding member.
      </p>
      
      <!-- Waitlist Form -->
      <form id="cta-waitlist-form" class="max-w-md mx-auto">
        <div class="glass-card p-2 flex flex-col sm:flex-row gap-3">
          <input 
            type="email" 
            name="email"
            placeholder="Enter your email" 
            required
            class="flex-1 input-dark bg-transparent border-0 focus:ring-0 focus:shadow-none"
          />
          <button type="submit" class="btn-primary whitespace-nowrap animate-pulse-glow">
            Join Waitlist
          </button>
        </div>
        
        <!-- Success Message -->
        <div id="cta-success-message" class="hidden mt-4 p-4 rounded-xl bg-green-500/10 border border-green-500/20">
          <div class="flex items-center justify-center gap-3 text-green-400">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
              <polyline points="22 4 12 14.01 9 11.01"/>
            </svg>
            <span class="font-medium">You're on the list!</span>
          </div>
        </div>
      </form>
      
      <!-- Trust Signals -->
      <div class="mt-8 flex flex-wrap items-center justify-center gap-6 text-sm text-zinc-500">
        <div class="flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-green-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          <span>No spam, ever</span>
        </div>
        <div class="flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-green-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          <span>Unsubscribe anytime</span>
        </div>
        <div class="flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-green-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="20 6 9 17 4 12"/>
          </svg>
          <span>Early access priority</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Footer -->
<footer class="py-8 border-t border-zinc-800/50">
  <div class="container">
    <div class="flex flex-col md:flex-row items-center justify-between gap-4 text-sm text-zinc-500">
      <div class="flex items-center gap-2">
        <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-violet-600 flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 2L2 7l10 5 10-5-10-5z"/>
            <path d="M2 17l10 5 10-5"/>
            <path d="M2 12l10 5 10-5"/>
          </svg>
        </div>
        <span class="font-medium text-zinc-400">Motor-FSRS</span>
      </div>
      
      <div>
        © 2026 Motor-FSRS. Built with science.
      </div>
      
      <div class="flex items-center gap-4">
        <a href="#" class="hover:text-purple-400 transition-colors">Privacy</a>
        <a href="#" class="hover:text-purple-400 transition-colors">Terms</a>
      </div>
    </div>
  </div>
</footer>

<script>
  const ctaForm = document.getElementById('cta-waitlist-form') as HTMLFormElement;
  const ctaSuccessMessage = document.getElementById('cta-success-message');
  
  ctaForm?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const formData = new FormData(ctaForm);
    const email = formData.get('email');
    
    try {
      const response = await fetch('/api/waitlist', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          email,
          martial_art: 'unknown',
          experience_level: 'unknown',
          utm_source: new URLSearchParams(window.location.search).get('utm_source') || '',
          utm_medium: new URLSearchParams(window.location.search).get('utm_medium') || '',
          utm_campaign: new URLSearchParams(window.location.search).get('utm_campaign') || '',
        }),
      });
      
      if (!response.ok) {
        const result = await response.json();
        throw new Error(result.error || 'Failed to join waitlist');
      }
      
      // Success
      ctaForm.classList.add('hidden');
      ctaSuccessMessage?.classList.remove('hidden');
      
    } catch (err) {
      console.error(err);
      alert('Something went wrong. Please try again.');
    }
  });
</script>
